{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "be32fb45_88b16974",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/pull/FetchAll.java",
        "patchSetId": 19
      },
      "lineNbr": 98,
      "author": {
        "id": 1157810
      },
      "writtenOn": "2023-10-12T09:54:46Z",
      "side": 1,
      "message": "This change is fine, however it is incomplete:\n- The entry point to this class is the `schedule` method (L68) which is _also called for SYNC operations_. \n- The `run()` method needs to be adapted, as L83 is applicable only for ASYNC.",
      "revId": "d1517dbe8d0d5c311721e6557e347e45f9dd3d82",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9a87277b_534164c6",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/pull/FetchAll.java",
        "patchSetId": 19
      },
      "lineNbr": 98,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2023-10-12T10:17:00Z",
      "side": 1,
      "message": "Let me check.",
      "parentUuid": "be32fb45_88b16974",
      "revId": "d1517dbe8d0d5c311721e6557e347e45f9dd3d82",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "aa94cf88_fbe464bd",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/pull/FetchOne.java",
        "patchSetId": 19
      },
      "lineNbr": 296,
      "author": {
        "id": 1157810
      },
      "writtenOn": "2023-10-12T09:54:46Z",
      "side": 1,
      "message": "FetchOne is tested, however looks like we have gaps here too. Perhaps we are using ASYNC replication in the tests.",
      "revId": "d1517dbe8d0d5c311721e6557e347e45f9dd3d82",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2234ae92_e4b3ca35",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/pull/FetchOne.java",
        "patchSetId": 19
      },
      "lineNbr": 296,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2023-10-12T10:14:10Z",
      "side": 1,
      "message": "Sure, I believe the focus of this change isn\u0027t reaching 100% test coverage of this class, isn\u0027t it?",
      "parentUuid": "aa94cf88_fbe464bd",
      "revId": "d1517dbe8d0d5c311721e6557e347e45f9dd3d82",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "0d4161fd_544a23a4",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/pull/FetchOne.java",
        "patchSetId": 19
      },
      "lineNbr": 296,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2023-10-12T10:17:00Z",
      "side": 1,
      "message": "Marking as resolved, we already have an issue to increase the test quality and coverage on this plugin, which is outside the scope of this change.",
      "parentUuid": "2234ae92_e4b3ca35",
      "revId": "d1517dbe8d0d5c311721e6557e347e45f9dd3d82",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b0763af3_5cab9e2f",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/pull/api/FetchCommand.java",
        "patchSetId": 19
      },
      "lineNbr": 102,
      "author": {
        "id": 1157810
      },
      "writtenOn": "2023-10-12T09:54:46Z",
      "side": 1,
      "message": "I think some unit tests here are beneficial, because they _both_ document the code and have the potential to catch problems that higher level tests won\u0027t catch:\n- A test to verify we are not scheduling anything\n- Tests on how we handle errors/non-happy path",
      "revId": "d1517dbe8d0d5c311721e6557e347e45f9dd3d82",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "be887190_54382080",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/pull/api/FetchCommand.java",
        "patchSetId": 19
      },
      "lineNbr": 102,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2023-10-12T10:14:10Z",
      "side": 1,
      "message": "\u003e I think some unit tests here are beneficial, because they _both_ document the code and have the potential to catch problems that higher level tests won\u0027t catch:\n\u003e - A test to verify we are not scheduling anything\n\nThat\u0027s an implementation detail: what happen if we change the scheduling mechanism? Why should the sync test-case have been amended?\n\n\u003e - Tests on how we handle errors/non-happy path\n\nSure, but how good are we in simulating them? Again, bear in mind that if the effort of writing the tests is higher than the effort and complexity of the implementation, we are just burning energy without producing much.",
      "parentUuid": "b0763af3_5cab9e2f",
      "revId": "d1517dbe8d0d5c311721e6557e347e45f9dd3d82",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "90356555_9cc8d265",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/pull/api/FetchCommand.java",
        "patchSetId": 19
      },
      "lineNbr": 102,
      "author": {
        "id": 1157810
      },
      "writtenOn": "2023-10-13T06:08:26Z",
      "side": 1,
      "message": "It may be an implementation detail (even on that I don\u0027t entirely agree, I think its a design decision that concerns the user but I will accept it for the sake of the conversation), but its quite an important one which has the potential to severely degrade the performance of the plugin - and more importantly, it is not verified by _any_ test. Even if we change the scheduling mechanism, the only amendment for the sync test-case will need to be the method name on which we assert it was called zero times, a very small price to pay IMO for what we are gaining.\n\nOn your 2nd point I agree there is some effort as we will need 2 layers of mocking, you\u0027re right that it\u0027s more complex than the implementation itself (I thought it was low cost but didnt study the code well enough).",
      "parentUuid": "be887190_54382080",
      "revId": "d1517dbe8d0d5c311721e6557e347e45f9dd3d82",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}