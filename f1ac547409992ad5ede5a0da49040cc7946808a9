{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "e84eedcb_9238ab46",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 10
      },
      "lineNbr": 0,
      "author": {
        "id": 1083454
      },
      "writtenOn": "2023-10-19T11:01:28Z",
      "side": 1,
      "message": "This is a design decision. Which I think can be done in a simpler way. Do we have any recording with the reasoning why this approach was taken?",
      "revId": "f1ac547409992ad5ede5a0da49040cc7946808a9",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "98a18670_1edc6b65",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/pull/StartFetchCommand.java",
        "patchSetId": 10
      },
      "lineNbr": 0,
      "author": {
        "id": 1022687
      },
      "writtenOn": "2023-10-19T14:33:03Z",
      "side": 1,
      "message": "Needs reformatting with GJF",
      "tag": "autogenerated:jenkins",
      "revId": "f1ac547409992ad5ede5a0da49040cc7946808a9",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "837c6c12_77a8d9db",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/pull/StartFetchCommand.java",
        "patchSetId": 10
      },
      "lineNbr": 0,
      "author": {
        "id": 1022687
      },
      "writtenOn": "2023-10-19T14:33:03Z",
      "side": 1,
      "message": "Needs reformatting with GJF",
      "tag": "autogenerated:jenkins",
      "revId": "f1ac547409992ad5ede5a0da49040cc7946808a9",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "eedb90f5_d4aebb28",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/pull/client/FetchApiClient.java",
        "patchSetId": 10
      },
      "lineNbr": 49,
      "author": {
        "id": 1157810
      },
      "writtenOn": "2023-10-19T10:11:09Z",
      "side": 1,
      "message": "```suggestion\n   * @param revisionData A history of revisions for the refs/meta/config ref.\n```",
      "revId": "f1ac547409992ad5ede5a0da49040cc7946808a9",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6eb4dfaf_5b099669",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/pull/client/FetchApiClient.java",
        "patchSetId": 10
      },
      "lineNbr": 49,
      "author": {
        "id": 1149185
      },
      "writtenOn": "2023-10-19T14:32:27Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "eedb90f5_d4aebb28",
      "revId": "f1ac547409992ad5ede5a0da49040cc7946808a9",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2cbc58c8_f5dab4f3",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/pull/client/FetchApiClient.java",
        "patchSetId": 10
      },
      "lineNbr": 53,
      "author": {
        "id": 1083454
      },
      "writtenOn": "2023-10-19T11:01:28Z",
      "side": 1,
      "message": "Is this really needed? Have we tried to send `refs/meta/config` json payload as a part of the same REST Api call? If other side is not supporting the configuration(rolling upgrade use case) it will just ignore it.",
      "range": {
        "startLine": 53,
        "startChar": 13,
        "endLine": 53,
        "endChar": 34
      },
      "revId": "f1ac547409992ad5ede5a0da49040cc7946808a9",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ba670aa2_d59057ef",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/pull/client/FetchApiClient.java",
        "patchSetId": 10
      },
      "lineNbr": 53,
      "author": {
        "id": 1149185
      },
      "writtenOn": "2023-10-19T11:21:55Z",
      "side": 1,
      "message": "We will have 2 different endpoints that represent the semantics of the operations, \n\n- old endpoint: \n  - semantic:  Init project WITHOUT configuration\n  - endpoint: /pull-replication/init-project/\u003cproject\u003e.git\n  - verb: PUT\n- new endpoint:\n  - semantic:  Init project WITH configuration\n  - endpoint: /pull-replication/init-project-with-config/\u003cproject\u003e.git\n  - verb: PUT  \n  - payload: JSON\n\n\nFor simplicity, let\u0027s assume that we have a primary/replica topology where `primary` node has the version of pull-replication with the new endpoint (client/server) and a `replica` has an old version of pull-replication without the new endpoint (client/server).\n\nBased on the tests done with the code in change 389916, when the primary makes a call to the new endpoint in the replica for `init project with configuration`, the replica will reply with `HTTP Status code 405 Not Allowed` and then the primary will fallback to the old endpoint and the `init project` request will be successful.",
      "parentUuid": "2cbc58c8_f5dab4f3",
      "range": {
        "startLine": 53,
        "startChar": 13,
        "endLine": 53,
        "endChar": 34
      },
      "revId": "f1ac547409992ad5ede5a0da49040cc7946808a9",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d0fd7919_6e32326b",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/pull/client/FetchApiClient.java",
        "patchSetId": 10
      },
      "lineNbr": 53,
      "author": {
        "id": 1083454
      },
      "writtenOn": "2023-10-19T11:29:25Z",
      "side": 1,
      "message": "but why we need extra endpoint? what is going to happen if we sent request to old endpoint in replica node with the json payload? is replica is just gonna ignore it? If yes we don\u0027t need new endpoint and fallback.\n\nI suggest to have a design meeting to discuss",
      "parentUuid": "ba670aa2_d59057ef",
      "range": {
        "startLine": 53,
        "startChar": 13,
        "endLine": 53,
        "endChar": 34
      },
      "revId": "f1ac547409992ad5ede5a0da49040cc7946808a9",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6815c418_896e805d",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/pull/client/FetchApiClient.java",
        "patchSetId": 10
      },
      "lineNbr": 53,
      "author": {
        "id": 1149185
      },
      "writtenOn": "2023-10-19T14:32:27Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "d0fd7919_6e32326b",
      "range": {
        "startLine": 53,
        "startChar": 13,
        "endLine": 53,
        "endChar": 34
      },
      "revId": "f1ac547409992ad5ede5a0da49040cc7946808a9",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}